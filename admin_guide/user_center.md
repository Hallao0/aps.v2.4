# 用户中心
## 功能简介

APS提供集中的用户管理、权限管理以及安全管理功能，使用户的生命周期管理和安全管理更加直观、易用。APS在用户中心提供的主要管理功能如下所示：

* 用户管理：在用户中心实现APS中用户的统一管理，并通过Kerberos协议认证用户。
    
    * APS通过在数据库和Kerberos中创建相同名字的用户，来配合实现用户管理。数据库用于存储用户记录、用户组与权限等用户信息；Kerberos中的用户信息则用于用户操作集群资源时的身份认证。
    
    * 当管理员在APS中创建或修改用户信息时，系统自动完成数据库和Kerberos中信息的同步更改。   

* 权限管理：使用RBAC（Role-Based Access Control）方式，即基于角色授予权限，形成权限的集合。用户通过分配一个或多个已授权的角色取得对应的权限。

    * 用户组为一批用户的集合，可对用户进行分类管理。系统中的用户至少要加入到一个组中。

    * 当用户加入已分配角色的用户组时，会自动继承用户组的权限。

* 安全管理：系统自动捕捉用户的各种操作并反馈给管理员，对于有危害的操作，管理员可以及时给予干预。
    
    * 消息中心记录在分析应用中的关键操作并通过消息的形式反馈给管理员。
    
    * 日志审计功能详细记录用户操作，帮助管理员了解系统中发生的各种事件。
    
* 标签管理：标签用于实现数据模块、分析模块的分类与管理。

在系统中，根据角色的不同，可以分为管理员和普通操作员，由于二者所具有的权限不同，因此登录系统后可查看的菜单范围不同。其中，管理员登录后系统显示用户中心下的所有菜单，而普通操作员登录后系统仅显示部分菜单，如可能仅显示“基本信息”和安全中心菜单。


## 基本信息

管理员可以在基本信息页面修改个人资料和密码。
在“用户中心”页签单击“基本信息”，系统显示基本信息编辑页面：

![](/admin_guide/fig/fig_05.jpg)

* 在“个人资料”页签下可以查看和修改如下信息：
    * 用户名：不可修改。
    * Email：格式为“登录名@主机名.域名”，例如user@zetyun.com。
    * 头像：可以选择系统提供的头像，也可以单击“点击上传”选择本地文件作为头像。
* 在“修改密码”页签下可以修改登录密码。  

## 安全中心

用户可以在安全中心进行KeyTab的管理。
KeyTab是用户进行集群资源操作的秘钥，用户在进行与集群资源相关的操作之前（例如运行一个交互探索服务）需要先获取KeyTab。
进入“安全中心”页面，可以查看KeyTab状态，当KeyTab状态正常时显示如下图所示：
![](/admin_guide/fig/fig_06.jpg)

在KetTab文件状态异常时，可以单击“获取”，在对话框中输入用户密码重新获取KeyTab，如下图所示：
![](/admin_guide/fig/fig_07.png)

## 消息中心

通过消息中心可以查看用户操作的执行结果。

### 消息类型

消息中心支持的消息类型包括：
* 分析模块发布：通知分析模块的发布结果。
* 模型发布：通知模型的发布结果。
* 任务通知：通知任务的运行结果。
* 系统权限：通知系统权限更改的操作结果。

### 消息状态

消息状态包括未读状态和已读状态，未读消息通过消息名称前的小圆点来标识。
![](/admin_guide/fig/fig_20.jpg)

### 消息管理

消息支持状态修改和删除操作。
* 选中一条或多条消息前的复选框，单击“删除”按钮，可以删除选中的消息。
* 选中一条或多条未读消息前的复选框，单击“标记为已读”，可以将消息置为已读状态。

## 用户管理

在实际业务中，管理员需要先明确使用APS的业务场景，规划用户对应的权限。然后在APS界面创建角色，并设置角色包含的权限以匹配业务的需求。通过用户组，管理员可以对具有相同业务场景的用户实现统一管理。

创建用户的具体操作流程如下所示：
![](/admin_guide/fig/fig_21.png)


### 新建用户

若APS采用AD进行鉴权，则只有通过AD鉴权且本地也存在的用户才可以登录APS。因此，对于在AD中新增的用户，需要在APS中创建同名的用户。
假设AD中新增了一个用户名为“Tom”的用户，此用户需要使用APS，则需要在APS中创建一个同名用户。

1. 选择“服务 > 用户中心 > 用户列表”。

2. 在用户列表页面单击右上角的“新建用户”按钮。

3. 在“新建用户”对话框中输入用户名“Tom”。
    ![](/admin_guide/fig/fig_08.png)
4. 单击“保存”，完成用户创建。

    此时可以在用户列表中看到该用户。
   
5. 编辑用户的属组。
   
    在创建好用户之后需要将用户加入用户组中，从而使用户获得相应权限。
   
    单击用户所在行的![](/admin_guide/fig/add.png)按钮，在“编辑用户组”对话框中选择用户需要加入的组，如下图所示。
    ![](/admin_guide/fig/fig_22.png)

6. 编辑用户可用资源。
   
    运行数据应用时需要一定的硬件资源，因此需要提前为用户指定其可用的资源配额。
   
    单击用户所在行的![](/admin_guide/fig/config_resource.png)按钮，在“资源管理”对话框中为用户配置其可用的CPU和内存资源，如下图所示。
    ![](/admin_guide/fig/fig_23.png)

### 删除用户

1. 选择“服务 > 用户中心 > 用户列表”。
2. 在用户列表中，勾选一个或多个用户前的复选框。
3. 单击页面右侧的“删除”按钮。
4. 在确认对话框中单击“删除”按钮，可以删除选中的用户。
    ![](/admin_guide/fig/fig_09.png)

    
## 用户分组

用户分组是进行用户管理的单位，用户通过加入一个或多个分组来继承相应分组所拥有的权限。
系统预置部分分组，管理员也可以根据实际需求创建新的分组。

### 新建用户组

1. 在“用户分组”页面的右上角单击“新建用户组”，系统显示“新建用户组”页面。
2. 配置用户组属性。
    * 名称：请根据实际情况设置。
    * 描述：添加用户分组的创建原因、用途等信息。
    * 用户：选择将哪些用户加入该分组中。
    * 角色：选择为该分组分配哪些角色。加入该分组的用户会继承分配给该分组的角色的权限。
3. 单击“确定”，完成分组的创建。
    ![](/admin_guide/fig/fig_12.png)

### 修改分组

1. 在用户分组列表中，单击某个分组所在行的 按钮，系统显示分组编辑页面。
2. 根据实际情况修改分组的描述、用户、角色。
3. 单击“确定”按钮，完成修改。
    ![](/admin_guide/fig/fig_13.png)

## 用户角色

用户角色是一组权限的集合，用户角色被赋予用户分组，用户分组中的用户即可继承该用户角色所拥有的权限。
系统预置的部分用户角色，管理员也可以根据实际需求创建新的角色。

### 新建角色

1. 在“用户角色”页面的右上角单击“新建用角色”，系统显示“创建用户角色”页面。
2. 配置用户角色属性。
    * 名称：请根据实际情况设置。
    * 描述：添加用户角色的创建原因、用途等信息。
    * 分析应用权限：选择为该角色赋予哪些权限。
3. 单击“确定”，完成角色创建。
    ![](/admin_guide/fig/fig_14.png)

### 修改角色

1. 在用户角色列表中，单击某个角色所在行的 按钮，系统显示角色编辑页面。
2. 根据实际情况修改角色的描述、权限。
3. 单击“确定”按钮，完成修改。
    ![](/admin_guide/fig/fig_15.png)
    
## 删除角色

用户角色只能逐个删除，不能批量删除。
1. 在用户角色列表中，单击某个角色所在行的![](/admin_guide/fig/delete.png)按钮。
2. 在确认对话框中单击“删除”按钮。

## 日志审计

日志审计记录了用户在系统中执行的各项操作，以方便管理员可以在需要的时候了解系统中发生的各种变更。系统提供的日志审计功能如下所示：
* 基于关键字的日志检索功能。
* 基于日期范围的日志下载功能。
* 基于多种指标的排序功能。

### 查看日志

1. 打开“日志审计”页面。
2. 对日志进行排序。

    日志支持三种排序类型，分别是“创建人”、“类型”、“创建时间”。在日志列表上方，单击排序类型后的 即可完成排序。
    ![](/admin_guide/fig/fig_16.png)

### 下载日志

1. 打开“日志审计”页面。
2. 单击页面右上角的“下载”按钮。
3. 在下载对话框中设置要下载日志的时间范围。
4. 单击“下载”按钮，开始下载。
    ![](/admin_guide/fig/fig_17.png)

### 筛选日志

1. 打开“日志审计”页面。
2. 单击页面右上角的“筛选”按钮。
3. 在下载对话框中设置筛选条件。
4. 单击“保存”按钮。
    ![](/admin_guide/fig/fig_18.png)

## 标签管理
标签具有数据应用、数据模块、分析模块三种类型。通过标签，可以按功能或应用场景对系统中的数据应用、数据模块、分析模块进行组织和管理，以便在使用时，可以快速找到对应的模块。

### 新建标签
管理员可以根据实际业务场景创建新的标签。

1. 打开“标签管理”页面。
2. 单击页面右上角“新建”按钮。
3. 在“新建标签”对话框中配置标签的模块和名称，如下所示：
    ![](/admin_guide/fig/fig_24.png)

4. 单击“保存”按钮，完成标签创建。

### 修改标签

标签在创建后只能修改名称，不能修改所属模块。

1. 打开“标签管理”页面。
2. 单击待修改标签所属的类型页签。
3. 在待修改标签所在行单击“编辑”按钮。
4. 在“编辑标签”对话框中，设置新的标签名称，如下所示：
    ![](/admin_guide/fig/fig_25.png)
5. 单击“确定”，完成修改。

### 删除标签

标签支持删除操作，但只有未被引用的标签才可以被删除。

1. 打开“标签管理”页面。
2. 单击待删除标签所属的类型页签。
3. 在待修改标签所在行单击“删除”按钮。
4. 在“删除标签”对话框中，单击“确定”按钮，完成删除操作。

    ![](/admin_guide/fig/fig_26.png)

### 调整标签顺序

标签顺序决定了标签的排列展示顺序，例如在数据应用创建过程中，数据模块以及分析模块下标签的排列顺序都是由标签管理页面配置的顺序决定的。当系统中存在较多的标签时，合理的标签顺序可以让用户快速找到所需的模块。

如下给出在分析模块页签下进行标签顺序调整的步骤，数据应用和数据模块下的操作过程与之相同。

1. 打开“标签管理”页面。
2. 单击“分析模块”页签，系统显示分析模块列表，如下所示。

    ![](/admin_guide/fig/fig_26.png)
    
3. 在列表中，单击某个标签所在行的“上移”或“下移”按钮即可向上或向下移动该标签。
